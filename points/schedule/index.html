<!DOCTYPE html>
<html lang="fr">
<head>
<style>
html, body {
	height:100%;
	width:100%;
	margin:0;
	padding:0;
}
.text {
	width:90%;
	height:90%;
}
</style>
<meta charset="utf-8" />
<title>Test outlook</title>
</head>
<body>
<!--
<input type="number" id="minYear" value="2017"></input>
<input type="number" id="maxYear" value="2030"></input>
-->
<button id="run">Click here to generate</button>
<br/>
<label>Result code</label>
<br/>
<textarea class="text" id="output"></textarea>
<script>
"use strict";
document.getElementById('run').addEventListener('click', function(){
	const result = new Map();
	const today = new Date();
	const diff = (today-new Date("1970-01-01")) / (1000 * 60 * 60 * 24);

	const rssIndex = (diff%4), doubleDip = (rssIndex%2);
	result.set(new Date(), "Insert hour of 1st rss : "+ (rssIndex === 0)===(doubleDip === 0)?"Food":"Oil");
	if (doubleDip === 0) {
		result.set(new Date(), "Insert hour of 2nd rss : " + rssIndex===2?"Food":"Oil");
	}
	// Oil
	// Food+Oil
	// Food
	// Oil+Food
	result.set(new Date(), "Test");
	
	
	let txt = "Debug example";
	for (var [date,name] of new Map([...result.entries()].sort(function(a,b){return a[0]-b[0];})))
		txt += "\n"+name+","+date.getFullYear()+"/"+(date.getMonth()+1)+"/"+date.getDate();
	document.getElementById('output').value = txt;
});
</script>
</body>
</html>
