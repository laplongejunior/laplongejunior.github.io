<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="referrer" content="never" />
<meta name="referrer" content="no-referrer" />
<noscript>
	<meta http-equiv="refresh" content="600" />
</noscript>
<title>Liste des absences du Ceria</title>
<link rel="stylesheet" href="https://laplongejunior.github.io/c/styleI.min.css" />
</head>
<body class="main">
<iframe id="fb" class="cell feed" data-src="https://www.facebook.com/plugins/page.php?href=https://www.facebook.com/456811884398747&tabs=timeline&hide_cover=true&show_facepile=false&hide_cta=false&small_header=true&adapt_container_width=false" sandbox="allow-same-origin allow-scripts"></iframe>
<iframe id="profs" class="cell site" src="https://www.translatetheweb.com/?from=en&to=fr&dl=fr&a=http://www.ceria.be/irl/index.php?option=com_content&view=article&id=114&Itemid=129" /*sandbox=""*/></iframe>
<div id="console" class="cell console">
	<noscript>
	Javascript est désactivé<br />
	Cette page s'auto-rafraîchira dans 10 minutes
	</noscript>
</div>
<script>
(function() {
	"use strict"
	// Log dans la page web
	let m_console = document.getElementById('console')
	
	const log = function(p_str) {	
		let start = m_console.firstChild
		if (start)
			m_console.insertBefore(start = document.createElement("br"), m_console.firstChild)
		const now = new Date()
		const pad = function(p_val) {return ('00' + p_val).slice(-2)}
		p_str = '['+pad(now.getHours())+':'+pad(now.getMinutes())+':'+pad(now.getSeconds())+'] ' + p_str
		m_console.insertBefore(document.createTextNode(p_str), start)
	}
	log('Console prête')
	
	const fbElement = document.getElementById('fb')
	
	// Calcul redimensionnement fb
	const m_fbSrc = fbElement.getAttribute('data-src')
	let m_prevWidth = -1, m_prevHeight = -1
	const refreshFb = function() {
		const style = getComputedStyle(fbElement)
		let width = parseInt(style['width'])
		let height = parseInt(style['height'])
	
		if (m_prevWidth === width && m_prevHeight === height)
			return
		m_prevWidth = width
		m_prevHeight = height
		
		fbElement.src = m_fbSrc + '&width='+width + '&height='+height
		log('Facebook '+width+'x'+height)
	}
	
	// Trigger redimensionnement fb
	let m_fbTimer
	const onResize = function() {
			if (m_fbTimer) clearTimeout(m_fbTimer)
			m_fbTimer = setTimeout(refreshFb, 5000)
		}
	addEventListener('load', onResize)
	addEventListener('resize', onResize)

	// En local, Chrome n'autorise pas à éditer depuis l'iframe
	let isTop
	try { isTop = (window === top) }
	catch (e) { isTop = false }
	if (isTop) {
		const link = document.createElement('link')
		link.rel = "icon"
		link.href = 'http://www.ceria.be/irl/templates/ja_purity/favicon.ico'
		document.head.appendChild(link)
	}
	
	// Rechargement
	const profsElement = document.getElementById('profs')
	setInterval(function(iframe) {
		const src = iframe.src
		iframe.src = 'about:blank'
		iframe.src = src
		log('Fenêtre Ceria rechargée')
	}, 600000, profsElement)

	// Suppression données inutiles
	fbElement.removeAttribute('data-src')
	m_console.removeAttribute('id')
	fbElement.removeAttribute('id')
	profsElement.removeAttribute('id')
})()
</script>
</body>
</html>
